//! Copyright (c) 2013 Alan Plum. MIT License
(function(a){function b(b,c){var d=null;return function(){return d||(d=b.apply(this,arguments),b=a.noop),c?c.apply(this,arguments):d}}function c(a,b,c){var d,e,f;for(c=c||0,d=0;a.api.length>d;d++)if(e=a.api[d],e[0]===b&&(f=e[1]||a.prototype[b],f.length===c))return f;return null}function g(b,c){this._options=a.extend({},c),this.$el=a("<div/>").css({position:"fixed",zIndex:11e3,left:"50%",top:0,marginLeft:0}).hide(),"string"==typeof b?this.$el.text(b):a(b).detach().appendTo(this.$el)}var d=Array.prototype.slice,e=a.extend(function(b){var h,e=d.call(arguments,1),f=c(g,b,e.length);if(f){if(h=f.apply(this.data("modal"),e),void 0!==h)return h}else this.each(function(){var c=a(this);c.data("modal")||c.data("modal",new g(this,b))});return this},{overlay:{background:"black",opacity:.5,showDuration:200,hideDuration:1},defaults:{hideDuration:200,showDuration:200},_overlay:f,_Modal:g}),f={$el:a("<div/>").css({position:"fixed",zIndex:1e4,left:0,top:0,width:"100%",height:"100%"}).hide(),open:b(function(){this.$el.appendTo("body")},function(a){var b=e.overlay,c=this.$el;c.css("background",b.background),c.fadeTo(b.showDuration,b.opacity,a)}),close:function(a){var b=e.overlay,c=this.$el;c.fadeOut(b.hideDuration,a)}};g.api=[["open"],["close"],["option",function(a){return this.getOption(a)}],["option",function(a,b){return this._options[a]=b,b}]],a.extend(g.prototype,{getOption:function(a){return this._options.hasOwnProperty(a)?this._options[a]:e.defaults[a]},open:function(){var b=this.getOption("showDuration"),c=this.$el;f.open(function(){c.appendTo("body").css({marginLeft:-(c.width()/2)+"px",top:a(window).height()/2-c.height()/2+"px"}).fadeIn(b)})},close:function(){var a=this.$el;a.fadeOut(this.getOption("hideDuration"),function(){a.detach(),f.close()})}}),a.fn.modal=e})(jQuery);
